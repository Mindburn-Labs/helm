{
  "generated_at": "2026-02-17T17:54:00Z",
  "type": "crypto_signature_evidence",
  "algorithms": {
    "signing": "Ed25519",
    "hashing": "SHA-256",
    "canonicalization": "JCS (RFC 8785)"
  },
  "key_locations": [
    {
      "purpose": "Receipt signing",
      "package": "crypto/signer.go",
      "key_type": "ed25519.PrivateKey",
      "creation": "ed25519.GenerateKey(crypto/rand.Reader)",
      "verification": "ed25519.Verify(pubKey, digest, sig)"
    },
    {
      "purpose": "PEM encoding/decoding",
      "package": "crypto/signer.go",
      "functions": ["MarshalPrivateKeyPEM", "MarshalPublicKeyPEM", "ParsePrivateKeyPEM", "ParsePublicKeyPEM"]
    },
    {
      "purpose": "JWT validation",
      "package": "auth/middleware.go",
      "library": "github.com/golang-jwt/jwt/v5",
      "key_source": "identity.KeySet"
    }
  ],
  "receipt_structure": {
    "fields": [
      "ReceiptID (UUID)",
      "LamportClock (uint64)",
      "Timestamp (RFC 3339)",
      "PrevHash (SHA-256 of previous receipt)",
      "ToolName (string)",
      "ArgsHash (SHA-256 of JCS(args))",
      "OutputHash (SHA-256 of JCS(output))",
      "PolicyVersion (string)",
      "Signature (Ed25519, base64)"
    ],
    "chain": "PrevHash → forms tamper-evident linked list",
    "ordering": "LamportClock + PrevHash → causal + topological",
    "determinism": "JCS canonicalization ensures cross-platform hash consistency"
  },
  "known_issues": [
    {
      "id": "SEC-001",
      "severity": "HIGH",
      "description": "proofgraph/node.go uses json.Encoder instead of JCS for node hashing",
      "impact": "Cross-platform hash inconsistency risk"
    },
    {
      "id": "SEC-002",
      "severity": "MEDIUM",
      "description": "evidence/exporter.go uses json.Marshal instead of JCS for sealing evidence bundles",
      "impact": "Evidence bundle hashes may vary across platforms"
    }
  ]
}
